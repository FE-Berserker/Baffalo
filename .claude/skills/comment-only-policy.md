# 代码注释修改策略

当用户要求添加或修改代码注释时，必须遵守以下规则。

## 核心规则

**当用户要求添加/修改注释时，只允许添加和修改注释，不能修改代码本体！**

## 适用场景

以下情况适用此规则：
- 用户明确说"添加注释"
- 用户说"修改注释"或"更新注释"
- 用户要求"给代码加上中文注释"
- 用户说"添加详细注释说明"
- 任何以添加/修改注释为目的的请求

## 禁止操作

❌ **不允许**在添加注释的同时修改代码逻辑
❌ **不允许**修正代码错误（除非是单纯的注释修正）
❌ **不允许**重构代码结构
❌ **不允许**优化代码性能
❌ **不允许**修改变量名
❌ **不允许**修改函数签名

## 允许操作

✅ **允许**添加新的注释行
✅ **允许**修改/更新现有注释内容
✅ **允许**添加函数头注释
✅ **允许**添加代码段分隔注释（`%%`）
✅ **允许**添加行尾注释
✅ **允许**删除或修改错误的注释

## MATLAB 注释格式

### 函数头注释

```matlab
function [output1, output2] = functionName(input1, input2)
% FunctionName - 函数功能描述
% 详细说明函数的作用和用途
% Author: 作者名
%
% Inputs:
%   input1 - 第一个输入参数的说明
%   input2 - 第二个输入参数的说明
%
% Outputs:
%   output1 - 第一个输出参数的说明
%   output2 - 第二个输出参数的说明

% 代码本体保持不变
output1 = calculate(input1);
output2 = input1 + input2;
end
```

### 代码段注释

```matlab
%% 初始化变量
x = 10;
y = 20;

%% 计算结果
z = x + y;
```

### 行尾注释

```matlab
x = 10;  % 设置初始值
y = x * 2;  % 计算两倍值
```

## 示例对比

### ❌ 错误做法（修改了代码）

```matlab
% 修改前
function result = add(a, b)
    result = a + b;
end

% 错误的添加注释方式
function result = add(a, b)
% Add - 计算两个数的和
% Author: XXX
    result = a + b;  % 这是对的，但下面那行不对
    result = result * 2;  % ❌ 不应该修改代码逻辑！
end
```

### ✅ 正确做法（只添加注释）

```matlab
% 修改前
function result = add(a, b)
    result = a + b;
end

% 正确的添加注释方式
function result = add(a, b)
% add - 计算两个数的和
% Author: XXX
%
% Inputs:
%   a - 第一个数
%   b - 第二个数
%
% Outputs:
%   result - 两个数的和
%
    result = a + b;  % 计算和
end
```

## 特殊情况处理

如果发现代码有明显错误，应该：

1. **只添加注释说明问题**，不直接修改代码
2. 在注释中指出错误和建议的修复方式

```matlab
function result = calculate(x)
    % TODO: 这里有一个除零风险，需要添加输入验证
    % 建议添加: if x == 0, error('输入不能为0'); end
    result = 10 / x;
end
```

## 执行流程

当收到添加/修改注释的请求时：

1. 仔细阅读代码，理解其功能
2. 在适当位置添加或修改注释
3. **确认没有修改任何代码逻辑**
4. 提交修改

## 常用注释模板

### 变量初始化
```matlab
%% 初始化参数
n = 10;  % 迭代次数
tol = 1e-6;  % 收敛容差
```

### 算法步骤
```matlab
%% 步骤1：数据预处理
data = preprocess(input);

%% 步骤2：主计算
result = mainAlgorithm(data);

%% 步骤3：结果后处理
output = postprocess(result);
```

### 重要说明
```matlab
% 注意：此函数假设输入已验证
% 如果输入包含NaN，结果可能不可靠
result = compute(value);
```

### MATLAB 特有注释

```matlab
%#ok<AGROW>  % 抑制变量增长的警告
%#ok<NASGU>  % 抑制变量未使用的警告
```

## 注意事项

1. **中文注释**：在中文环境下使用中文注释
2. **注释符号**：只使用 `%`，不要使用 `#`（这是Python的注释符号）
3. **缩进**：注释保持与代码相同的缩进级别
4. **一致性**：保持注释风格与项目中现有代码一致
5. **简洁性**：注释应该简洁明了，说明"为什么"而不是"是什么"

## 违规后果

违反此规则可能导致：
- 代码逻辑被意外修改
- 引入新的bug
- 用户不满
- 需要回滚更改

**请严格遵守此规则！**
